SELECT DISTINCT A.FACT_ODR_NO, A.MAT_NO, D.MAT_SIZE, A.PART_NO, E.CTNSPEC_NO, E.TOTAL_CTN, decode(D.unit_weight,0,0,round(1/unit_weight,6)) "Propotional_weight", C.SHIP_DATE
FROM MDMIS.PURPLANM A, MDMIS.PURPLAND B, MDMIS.ODRM C, MDMIS.MATSIZE_WGT D, (SELECT FACT_ODR_NO, CTNSPEC_NO, SUM(TOT_CTN) AS TOTAL_CTN FROM MDMIS.ODRPACKM GROUP BY CTNSPEC_NO,FACT_ODR_NO) E 
WHERE A.PURPLAN_NO = B.PURPLAN_NO
AND A.PART_NO = 'M350'
AND A.PURPLAN_SEQ = B.PURPLAN_SEQ
AND C.SHIP_DATE between 'frDate'and'toDate'
AND A.FACT_ODR_NO = C.FACT_ODR_NO
AND A.MAT_NO = D.MAT_NO
AND B.PUR_MAT_SIZE = D.MAT_SIZE
AND A.FACT_ODR_NO = E.FACT_ODR_NO
AND D.MAT_SIZE = E.CTNSPEC_NO